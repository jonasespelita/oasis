<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html>
<head>
<title>OASIS Administrator</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<%= javascript_include_tag 'prototype' %>
<!-- webfxlayout.js -->
<script type="text/javascript">

/* Do includes */

if (window.pathToRoot == null)
  pathToRoot = "./";

document.write('<link type="text/css" rel="stylesheet" href="local/webfxlayout.css">');
webfxMenuDefaultImagePath = pathToRoot + "images/";

/* end includes */

/* set up browser checks and add a simple emulation for IE4 */

// check browsers
var op = /opera 5|opera\/5/i.test(navigator.userAgent);
var ie = !op && /msie/i.test(navigator.userAgent);  // preventing opera to be identified as ie
var mz = !op && /mozilla\/5/i.test(navigator.userAgent);  // preventing opera to be identified as mz

if (ie && document.getElementById == null) {  // ie4
  document.getElementById = function(sId) {
    return document.all[sId];
  };
}

/* end browser checks */

if (ie && window.attachEvent) {
  window.attachEvent("onload", function () {
    var scrollBorderColor  =  "rgb(120,172,255)";
    var scrollFaceColor    =  "rgb(234,242,255)";
    with (document.body.style) {
      scrollbarDarkShadowColor  =  scrollBorderColor;
      scrollbar3dLightColor    =  scrollBorderColor;
      scrollbarArrowColor      =  "black";
      scrollbarBaseColor      =  scrollFaceColor;
      scrollbarFaceColor      =  scrollFaceColor;
      scrollbarHighlightColor    =  scrollFaceColor;
      scrollbarShadowColor    =  scrollFaceColor;
      scrollbarTrackColor      =  "white";
    }
  });
}

/* we also need some dummy constructors */
webfxMenuBar = {
  add : function () {}
};
function WebFXMenu() {
  this.add = function () {};
}
function WebFXMenuItem() {}
function WebFXMenuSeparator() {}
function WebFXMenuButton() {}
</script>


<script type="text/javascript" src="/javascripts/webLayout.js"></script>
<script type="text/javascript" src="/javascripts/bwslist.js"></script>


</head>
<body>

<script type="text/javascript">
	function setLinkSrc( sStyle ) {
	  document.getElementById( "luna-tab-style-sheet" ).disabled = sStyle != "luna";
	  document.getElementById( "webfx-tab-style-sheet" ).disabled = sStyle != "webfx"
	  document.getElementById( "winclassic-tab-style-sheet" ).disabled = sStyle != "winclassic"
	  
	  document.documentElement.style.background = 
	  document.body.style.background = sStyle == "webfx" ? "white" : "ThreeDFace";  
	}

	setLinkSrc( "luna" );
</script>

<div class="container">	
	<div class="admin_title"><b>OASIS Administrator</b></div>
	<div class="topmenu" style="left:194px;">
		<%= link_to 'Logout', :action => 'logout' %>
		|
		<%= link_to 'Change Password', :action => 'settings' %>
		<hr />		
	</div>
	
	<div class="logo">
		<div class="invis">
			<h1>OASIS</h1><br/><h2>Online Access Student Information System</h2>
		</div>
	</div>
	
	<div class="slu">
		<div class="invis">
			<h2>Saint Louis University</h2>
		</div>
	</div>
	
	
	
	<div class="tab-pane">

	<script type="text/javascript">
	tp1 = new WebFXTabPane( document.getElementById( "tabPane1" ) );
	//tp1.setClassNameTag( "dynamic-tab-pane-control-luna" );
	//alert( 0 )
	</script>
	<% if @is_oa %>
	 <div class="tab-page" id="tabPage1">
	    <h2 class="tab">Administrator Management</h2>
	    
	    <script type="text/javascript">tp1.addTabPage( document.getElementById( "tabPage1" ) );</script>
		
		<fieldset class="fieldset" style="width: 920px; height:195px;">
			<legend class="groupbox">Administrators</legend>
			<div style="position:relative; overflow:auto; "onclick="clickEditAdmin()">
			<script language="text/javascript" type="text/javascript">
				<!--
				//  let's create our list object
				var nlr1=new mylist('nlr1','dvia1',5,200,180,177,200,150);
				//  set it's width and height  
				nlr1.setDims(300,100);
				//  create array for item addition - you can use the same array for the header and items
				var aa=new Array(9);
				//  fill the array with contents (now for the header)
				aa[0]='Name';
				aa[1]='Username';
				aa[2]='Position';
				aa[3]='Last Visit';
				aa[4]='Active';
				//  update the header and redraw
				nlr1.updateHeader(aa);
				<% @admins.each{ |admin| %>
						<%	unless admin.position == 'oa' %>
							aa[0]= <%= admin.get_name.to_json %>
							aa[1]= <%= admin.username.to_json %>
							aa[2]= <%= admin.position.to_json %>
							<% if admin.last_visit.nil? %>
								aa[3]= 'n/a'
							<% else %>
								aa[3]= <%= admin.last_visit.strftime("%m/%d/%Y %I:%M%p").to_json %>
							<% end %> 
							aa[4]= <%= if admin.active then ('Active').to_json else ('Inactive').to_json end %>
							aa[5]= <%= admin.first_name.to_json %>
							aa[6]= <%= admin.last_name.to_json %>
							aa[7]= <%= admin.email.to_json %>
							aa[8]= <%= admin.id.to_json %>
							nlr1.silentAdd(aa)
						<% end%>
					<% } %>
					<% remain = 5 - @admins.length %>
					<% if remain > 0 %>
						<% remain.times do %>
							aa[0]= ''
							aa[1]= ''
							aa[2]= ''
							aa[3]= ''
							aa[4]= ''
							aa[5]= ''
							aa[6]= ''
							aa[7]= ''
							aa[8]= ''
							nlr1.silentAdd(aa)
						<% end %>
					<% end %>
				nlr1.draw();
				-->  
			</script>
			</div>
			<div style="position:relative;top:16px; float:right;left:-20px ">				
				<%= button_to_function "Add", "addAdmin()" %>
				<%= button_to_function "Activate", "enableAdmin()" %>	 
				<%= button_to_function "Deactivate", "disableAdmin()" %>	 
			</div>
	    </fieldset>
		<br /><br />
		<fieldset id= "editAdmin" class="fieldset" style="width:920px; height:150px;display:none">
			<legend class="groupbox">Edit</legend>
				<% form_tag '/admin/edit_admin', :id => "edit_admin" do %>
				<div style="position:relative; float:left;">
					<span style="position:relative; top:0px;">
						<label for="First_name">First name:
      					<%= text_field_tag :edit_admin_first_name, params[:edit_admin_first_name], :size => 45 %>
      					<%= hidden_field_tag :edit_admin_id, params[:edit_admin_id] %>
      				</label>
      				<br>
      				</br>
					</span>
					<span style="position:relative; top:6px;">
						<label for="Last_name">Last name:
							<span style="position:relative; left:1px;">
      					<%= text_field_tag :edit_admin_last_name, params[:edit_admin_last_name], :size => 45 %>
      					</span>
      				</label>
      				<br>
      				</br>
					</span>						
						<span style="position:relative; top:12px;">
							<label for="Position">Position:
							<span style="position:relative; left:15px;">
      					<%= text_field_tag :edit_admin_position, params[:edit_admin_position], :size => 45 %>
      					</span>
      					</label>
      				<br>
      				</br>
					</span>
					<span style="position:relative; top:18px;">
						<label for="Username">Username:
							<span style="position:relative;left:3px;">
      					<%= text_field_tag :edit_admin_username, params[:edit_admin_username], :size => 45 %>
      					</span>
      				</label>
      				<br>
      				</br>
      			</span>
				</div>
				<div style="position:absolute; left:480px;">
					
					<span style="position:relative; top:0px;">
						<% if flash[:notice] == "Edit admin passwords do not match" %>
						<label for="Password" style="color:red">Password:
						<% else %>
						<label for="Password">Password:
						<% end %>
							<span style="position:relative; left:2px">
      					<%= password_field_tag :edit_admin_password, params[:edit_admin_password], :size => 45 %>
      					</span>
      				</label>
      				<br>
      				</br>
					</span>
					<span style="position:relative; top:6px;">
						<% if flash[:notice] == "Edit admin passwords do not match" %>
						<label for="Confirm" style="color:red">Confirm:
						<% else %>
						<label for="Confirm">Confirm:
						<% end %>
							<span style="position:relative; left:15px">
      					<%= password_field_tag :edit_admin_confirm, params[:edit_admin_confirm], :size => 45 %>
      					</span>
      				</label>
      				<br>
      				</br>
					</span>
					<span style="position:relative; top:12px;">
						<label for="Email">Email:
							<span style="position:relative;left:26px">
      					<%= text_field_tag :edit_admin_email, params[:edit_admin_email], :size => 45 %>
      					</span>
      				</label>
      				<br>
      				</br>
					</span>
				</div>				 
			<div style="position:relative; float:right; top:100px; left:-5px">
				<%= submit_tag "Save" %>
				<%= button_to_function "Cancel", "cancelAdminEdit()" %>	  
			</div>
			<% end %>
	    </fieldset>		
		<br /><br />
		<% if flash[:notice] == "Add admin passwords do not match" %>
		<fieldset id= "addAdmin" class="fieldset" style="width: 920px; height:150px;">
		<% else %>
		<fieldset id= "addAdmin" class="fieldset" style="width: 920px; height:150px;display:none">
		<% end %>
			<legend class="groupbox">Add New</legend>
		  		<% form_tag '/admin/add_admin', :id => "add_admin" do %>
				<div style="position:relative; float:left;">
					<span style="position:relative; top:0px;">
						<label for="First_name">First name:
      					<%= text_field_tag :add_admin_first_name, params[:add_admin_first_name], :size => 45 %>
      				</label>
      				<br>
      				</br>
					</span>
					<span style="position:relative; top:6px;">
						<label for="Last_name">Last name:
							<span style="position:relative; left:1px;">
      					<%= text_field_tag :add_admin_last_name, params[:add_admin_last_name], :size => 45 %>
      					</span>
      				</label>
      				<br>
      				</br>
					</span>						
						<span style="position:relative; top:12px;">
							<label for="Position">Position:
							<span style="position:relative; left:15px;">
      					<%= text_field_tag :add_admin_position, params[:add_admin_position], :size => 45 %>
      					</span>
      					</label>
      				<br>
      				</br>
					</span>
					<span style="position:relative; top:18px;">
						<label for="Username">Username:
							<span style="position:relative;left:3px">
      					<%= text_field_tag :add_admin_username, params[:add_admin_username], :size => 45 %>
      					</span>
      				</label>
      				<br>
      				</br>
					</span>
				</div>
			
				<div style="position:absolute; left:480px;">
					
					<span style="position:relative; top:0px;">
					<% if flash[:notice] == "Add admin passwords do not match" %>
					<label for="Password" style="color:red">Password:
					<% else %>
					<label for="Password">Password:
					<% end %>
							<span style="position:relative; left:2px">
      					<%= password_field_tag :add_admin_password, params[:add_admin_password], :size => 45 %>
      					</span>
      				</label>
      				<br>
      				</br>
					</span>
					<span style="position:relative; top:6px;">
						<% if flash[:notice] == "Add admin passwords do not match" %>
						<label for="Confirm" style="color:red">Confirm:
						<% else %>
						<label for="Confirm">Confirm:
						<% end %>
							<span style="position:relative; left:15px;">
						
      					<%= password_field_tag :add_admin_confirm, params[:add_admin_confirm], :size => 45 %>
      					</span>
      				</label>
      				<br>
      				</br>
					</span>
					<span style="position:relative; top:12px;">
						<label for="Email">Email:
							<span style="position:relative;left:26px">
      					<%= text_field_tag :add_admin_email, params[:add_admin_email], :size => 45 %>
      					</span>
      				</label>
      				<br>
      				</br>
					</span>
				</div>				 
			<div style="position:relative; float:right; top:100px; left:-5px;">
				<%= submit_tag "Save" %>
				<%= button_to_function "Cancel", "cancelAdminAdd()" %>	  	  
			</div>
			<% end %>
	    </fieldset>
		<% form_tag '/admin/enable_admin', :id => "enable_admin" do %>
		  <%= hidden_field_tag :enable_admin_id, params[:enable_admin_id] %>
		<% end %>
		<% form_tag '/admin/disable_admin', :id => "disable_admin" do %>
		  <%= hidden_field_tag :disable_admin_id, params[:disable_admin_id] %>
		<% end %>
		<% form_tag :id => "admin_selected" do %>
		  <%= hidden_field_tag :var_selected %>
		<% end %>
	  </div>
	 
	  <script language="text/javascript" type="text/javascript">
			function clickEditAdmin() {
				var i = nlr1.selected;
				document.getElementById("edit_admin_first_name").value = nlr1.elements[i][5];
				document.getElementById("edit_admin_last_name").value = nlr1.elements[i][6];
				document.getElementById("edit_admin_position").value = nlr1.elements[i][2];
				document.getElementById("edit_admin_username").value = nlr1.elements[i][1];
				document.getElementById("edit_admin_password").value = ""
				document.getElementById("edit_admin_confirm").value = ""
				document.getElementById("edit_admin_email").value = nlr1.elements[i][7];
				document.getElementById("edit_admin_id").value = nlr1.elements[i][8];		
				document.getElementById("disable_admin_id").value = nlr1.elements[i][8];	
				document.getElementById("enable_admin_id").value = nlr1.elements[i][8];	
				Element.show('editAdmin');
				
			}
			<% if flash[:notice] == "Edit admin passwords do not match" %>
			clickEditAdmin()
			<% end %>
			function cancelAdminAdd() {
				document.getElementById("add_admin_first_name").value = ""
				document.getElementById("add_admin_last_name").value = ""
				document.getElementById("add_admin_position").value = ""
				document.getElementById("add_admin_username").value = ""		
				document.getElementById("add_admin_password").value = ""
				document.getElementById("add_admin_confirm").value = ""
				document.getElementById("add_admin_email").value = ""
				Element.hide('addAdmin');
			}
			function cancelAdminEdit() {
				document.getElementById("edit_admin_first_name").value = ""
				document.getElementById("edit_admin_last_name").value = ""
				document.getElementById("edit_admin_position").value = ""
				document.getElementById("edit_admin_username").value = ""		
				document.getElementById("edit_admin_password").value = ""
				document.getElementById("edit_admin_confirm").value = ""
				document.getElementById("edit_admin_email").value = ""
				Element.hide('editAdmin');		
			}
			function enableAdmin(){
				document.getElementById("enable_admin").submit();
			}
			function disableAdmin(){
				document.getElementById("disable_admin").submit();	
			}
			function addAdmin(){
				Element.show('addAdmin');
			}
			
		</script>
       <% end %>
	  <div class="tab-page" id="tabPage2">
	    <h2 class="tab">System Reports</h2>
	    
	    <script type="text/javascript">tp1.addTabPage( document.getElementById( "tabPage2" ) );</script>
	    
		<div class="sys_groupbox1">
			<fieldset class="fieldset" style="width:100px; height:590px;">
				<legend class="groupbox">Visits Per Day</legend>
					From: <select><option>August 20, 2008</option></select>&nbsp;&nbsp;To: <select><option>September 18, 2008</option></select>&nbsp;
					<input type="button" value="Filter">
					<br />
					<span style="position:relative; font-size:14px; top:3px;"><b>Showing 1-29 of 29</b></span>
					<div style="position:relative; overflow:auto; height:500px; top:4px;">
						<script language="text/javascript" type="text/javascript">
						<!--
						//  let's create our list object
						var nlr2=new mylist('nlr2','dvia2',3,158,110,110);
						//  set it's width and height  
						nlr2.setDims(300,100);
						//  create array for item addition - you can use the same array for the header and items
						var ab=new Array(3);
						//  fill the array with contents (now for the header)
						ab[0]='Date';
						ab[1]='Total';
						ab[2]='Unique';

						//  update the header and redraw
						nlr2.updateHeader(ab);
						ab[0]='September 18, 2008'
						ab[1]='724';
						ab[2]='600';
						nlr2.silentAdd(ab);
						
						ab[0]='September 17, 2008'
						ab[1]='705';
						ab[2]='556';
						nlr2.silentAdd(ab);
						
						ab[0]='September 16, 2008'
						ab[1]='471';
						ab[2]='409';
						nlr2.silentAdd(ab);
						
						ab[0]='September 15, 2008'
						ab[1]='381';
						ab[2]='287';
						nlr2.silentAdd(ab);
						
						ab[0]='September 14, 2008'
						ab[1]='369';
						ab[2]='316';
						nlr2.silentAdd(ab);
						
						ab[0]='September 13, 2008'
						ab[1]='581';
						ab[2]='472';
						nlr2.silentAdd(ab);
						
						ab[0]='September 12, 2008'
						ab[1]='1040';
						ab[2]='634';
						nlr2.silentAdd(ab);
						
						ab[0]='September 11, 2008'
						ab[1]='1016';
						ab[2]='179';
						nlr2.silentAdd(ab);
						
						ab[0]='September 10, 2008'
						ab[1]='216';
						ab[2]='44';
						nlr2.silentAdd(ab);
						
						ab[0]='September 9, 2008'
						ab[1]='393';
						ab[2]='271';
						nlr2.silentAdd(ab);
						
						ab[0]='September 8, 2008'
						ab[1]='575';
						ab[2]='383';
						nlr2.silentAdd(ab);
						
						ab[0]='September 7, 2008'
						ab[1]='1059';
						ab[2]='170';
						nlr2.silentAdd(ab);
						
						ab[0]='September 6, 2008'
						ab[1]='490';
						ab[2]='392';
						nlr2.silentAdd(ab);
						
						ab[0]='September 5, 2008'
						ab[1]='428';
						ab[2]='80';
						nlr2.silentAdd(ab);
						
						ab[0]='September 4, 2008'
						ab[1]='654';
						ab[2]='627';
						nlr2.silentAdd(ab);
						
						ab[0]='September 3, 2008'
						ab[1]='466';
						ab[2]='305';
						nlr2.silentAdd(ab);
						
						ab[0]='September 2, 2008'
						ab[1]='985';
						ab[2]='167';
						nlr2.silentAdd(ab);
						
						ab[0]='September 1, 2008'
						ab[1]='979';
						ab[2]='259';
						nlr2.silentAdd(ab);
						
						ab[0]='August 31, 2008'
						ab[1]='971';
						ab[2]='287';
						nlr2.silentAdd(ab);
						
						ab[0]='August 30, 2008'
						ab[1]='1070';
						ab[2]='735';
						nlr2.silentAdd(ab);
						
						ab[0]='August 29, 2008'
						ab[1]='429';
						ab[2]='396';
						nlr2.silentAdd(ab);
						
						ab[0]='August 28, 2008'
						ab[1]='466';
						ab[2]='443';
						nlr2.silentAdd(ab);
						
						ab[0]='August 27, 2008'
						ab[1]='1026';
						ab[2]='406';
						nlr2.silentAdd(ab);
						
						ab[0]='August 26, 2008'
						ab[1]='572';
						ab[2]='514';
						nlr2.silentAdd(ab);
						
						ab[0]='August 25, 2008'
						ab[1]='927';
						ab[2]='373';
						nlr2.silentAdd(ab);
						
						ab[0]='August 24, 2008'
						ab[1]='510';
						ab[2]='234';
						nlr2.silentAdd(ab);
						
						ab[0]='August 23, 2008'
						ab[1]='374';
						ab[2]='229';
						nlr2.silentAdd(ab);
						
						ab[0]='August 22, 2008'
						ab[1]='820';
						ab[2]='784';
						nlr2.silentAdd(ab);
						
						ab[0]='August 21, 2008'
						ab[1]='969';
						ab[2]='431';
						nlr2.silentAdd(ab);
						
						ab[0]='August 20, 2008'
						ab[1]='499';
						ab[2]='284';
						nlr2.silentAdd(ab);

						
						nlr2.draw();
						-->  
					  </script>
					 </div>
					 <br />
					 <center><< 1 2 3 4 5 6 7 8 9 10 >></center>
			    </fieldset>		
			</div>
			<div class="sys_groupbox2">
				<fieldset class="fieldset" style="width: 440px; height: 102px;">
				<legend class="groupbox">Administrators Online</legend>
					<script language="text/javascript" type="text/javascript">
						<!--
						//  let's create our list object
						var nlr3=new mylist('nlr3','dvia3',3,97,200,134);
						//  set it's width and height  
						nlr3.setDims(300,100);
						//  create array for item addition - you can use the same array for the header and items
						var ac=new Array(3);
						//  fill the array with contents (now for the header)
						ac[0]='Date/Time';
						ac[1]='Name';
						ac[2]='Position';

						//  update the header and redraw
						nlr3.updateHeader(ac);

						ac[0]='9-14-2008 9:30AM';
						ac[1]='Jennifer Walters';
						ac[2]='User Administrator';					
						nlr3.silentAdd(ac);
						ac[0]='9-14-2008 9:45AM';
						ac[1]='Karlos Ong';
						ac[2]='Content Administrator';					
						nlr3.silentAdd(ac);					

						nlr3.draw();
						-->  
				  </script>
		    </fieldset>
			<br /><br />
			<fieldset class="fieldset" style="width: 440px;">
				<legend class="groupbox">Record Statistics</legend>
				<div style="float:left; text-align:right;">
					Number of Registered Users: <br /><br />
					Number of Student Records: <br /><br />
					Number of New Student Records:  <br /><br />
					Last Update of Records: <br /><br />
					Number of Currently Online Users: <br /><br />
					Most Number of Users Online: <br /><br />
					Most Online Users was on: <br /><br />			
					Records Deleted Last: <br /><br />
					Number of Blocked Accounts: <br /><br />
				</div>
				<div style="position:relative; float:left; text-alignt:right; left:10px; top:1px;">
					15,825 <br /><br />
					21,512 <br /><br />
					265 <br /><br />
					9-17-2008 <br /><br />
					541 <br /><br />
					1,201 <br /><br />
					7-7-2008 <br /><br />
					9-12-2008 <br /><br />
					12
				</div>
		    </fieldset>
	    </div>
	  </div>

	  <div class="tab-page" id="tabPage3">
	    <h2 class="tab">Actions Log</h2>
	    
	    <script type="text/javascript">tp1.addTabPage( document.getElementById( "tabPage3" ) );</script>
	    
		From: <select><option>September 16, 2008</option></select>&nbsp;&nbsp;&nbsp;To: <select><option>September 17, 2008</option></select>			
		&nbsp;&nbsp;<input type="button" value="Filter">
		
		<br /><br />
		
		<fieldset class="fieldset" style="width: 920px; height: 525px;">	
			<div style="overflow:auto; height:525px;">
				<script language="text/javascript" type="text/javascript">
					<!--
					//  let's create our list object
					var nlr4=new mylist('nlr4','dvia4',4,155,200,400,154);
					//  set it's width and height  
					nlr4.setDims(300,100);
					//  create array for item addition - you can use the same array for the header and items
					var ad=new Array(4);
					//  fill the array with contents (now for the header)
					ad[0]='Date/Time';
					ad[1]='Name';
					ad[2]='Action Performed';				
					ad[3]='IP Address';

					//  update the header and redraw
					nlr4.updateHeader(ad);
					<% @changes.each{ |change| %>
					
							ad[0]= <%= change.created_at.strftime("%m/%d/%Y %I:%M%p").to_json %>
							ad[1]= <%= Admin.find(change.admin_id).get_name.to_json %>
							ad[2]= <%= change.change_made.to_json %>
							ad[3]= <%= change.ip_add.to_json %>
							nlr4.silentAdd(ad)
						
					<% } %>

					ad[0]='September 17, 2008 23:59';
					ad[1]='Karlos Ong';
					ad[2]='Blocked Account';
					ad[3]='192.168.100.100';
					nlr4.silentAdd(ad);
					
				
					
					nlr4.draw();
					-->  
			  </script>
			</div>
		</fieldset>
		   <span style= "float:right;">
	    		<%= button_to "Download Reports to Excel", :action => "export_actions" %>
	    	</span>
	  </div>	  
	  
	  <div class="tab-page" id="tabPage3">
	    <h2 class="tab">Announcements</h2>
	    
	    <script type="text/javascript">tp1.addTabPage( document.getElementById( "tabPage3" ) );</script>
	    
		<div class="sys_groupbox1">
			<fieldset class="fieldset" style="width: 400px; height:574px;">
				<legend class="groupbox">Annoucements</legend>
				<div style="position:relative; overflow:auto; height:520px; top:4px;"onclick="clickEditAnn()">
				<script language="text/javascript" type="text/javascript">
					<!--
					//  let's create our list object
					var nlr10=new mylist('nlr10','dvia10',2,120,260);
					//  set it's width and height  
					nlr10.setDims(300,100);
					//  create array for item addition - you can use the same array for the header and items
					var aj=new Array(4);
					//  fill the array with contents (now for the header)
					aj[0]='Date/Time';
					aj[1]='Activity';

					//  update the header and redraw
					nlr10.updateHeader(aj);

						<% @announcements.each{ |announcement| %>
						aj[0]= <%= announcement.date_time.strftime("%m/%d/%Y %I:%M%p").to_json %>
						aj[1]= <%= announcement.announcement.to_json %>
						aj[2]= <%= announcement.summary.to_json %>
						aj[3]= <%= announcement.id.to_json %>
						nlr10.silentAdd(aj)
					<% } %>
					<% remain = 25 - @announcements.length %>
					<% if remain > 0 %>
						<% remain.times do %>
							aj[0]= ''
							aj[1]= ''
							aj[2]= ''
							aj[3]= ''
							nlr10.silentAdd(aj)
						<% end %>
					<% end %>
					
					nlr10.draw();
					-->  
				</script>				
				</div>				
				<input type="button" name="btn" value="Delete" style="position:relative;float:right; top:13px;" onclick="clickDeleteAnn()">
				<input type="button" name="btn" value="Add" style="position:relative;float:right; top:13px; left:-5px;" onclick="clickAddAnn()">						
		    </fieldset>
		</div>
		<div class="sys_groupbox2">
			<fieldset id= "editAnnouncement" class="fieldset" style="width:420px; height:273px;display:none;">
				<legend class="groupbox">Edit Announcement</legend>
					<div style="float:left; left:10px; text-align:right; width:130px;">
						<span style="position:relative; left:-20px; top:3px;">
					Announcement: <br />
						</span>
						<span style="position:relative;left:-20px; top:17px;">
							Date/Time: <br />
						</span>
						<span style="position:relative;left:-20px; top:31px;">
							Summary: <br />
						</span>
					</div>
					<div style="position:relative; float:left;left:-20px; width: 80px;">
				<% form_tag '/admin/edit_announcement', :id => "edit_announcement" do %>

								<div>
									<span style="position:relative; top:2px;">
										<%= text_field_tag :edit_announcement_name, params[:edit_announcement_name], :size => 30 %>
									</span>
									<span style="position:relative; top:10px;">
										<%= text_field_tag :edit_announcement_date, params[:edit_announcement_date], :size => 30 %>
									</span>
									<span style="position:relative; top:20px;">
										<%= text_area_tag :edit_announcement_summary, params[:edit_announcement_summary], :size => "40x9" %>
										<%= hidden_field_tag :edit_announcement_id, params[:edit_announcement_id] %>
										
									</span>
									<span style="position:relative; top:25px; float:right; left:172px;">
										<%= submit_tag "Save" %>
									</span>
									<span style="position:relative; float:right; left:230px;">
										<%= button_to_function "Cancel", "cancelAnnEdit()" %>
									</span>
								</div>
						<% end %>
						<% form_tag '/admin/delete_announcement', :id => "delete_ann" do %>
							<%= hidden_field_tag :delete_announcement_id, params[:delete_announcement_id] %>
							<%= hidden_field_tag :delete_announcement_name, params[:delete_announcement_name] %>
						<% end %>
					</div>					
		    </fieldset>
			<br />
			<fieldset id= "addAnnouncement" class="fieldset" style="width:420px; height:273px;display:none;">
				<legend class="groupbox">Add New Announcement</legend>
					<div style="float:left; left:10px; text-align:right; width:130px;">
						<span style="position:relative;left:-20px; top:3px;">
					Announcement: <br />
						</span>
						<span style="position:relative;left:-20px; top:17px;">
							Date/Time: <br />
						</span>
						<span style="position:relative;left:-20px; top:31px;">
							Summary: <br />
						</span>
					</div>
					<div style="position:relative; float:left;left:-20px; width: 80px;">
					
							<% form_remote_tag :id => 'add_announcement', :url => { :action => 'add_announcement' } do %>

								<div>
									<span style="position:relative; top:2px;">
										<%= text_field_tag :add_announcement_name, params[:add_announcement_name], :size => 30 %>
									</span>
									<span style="position:relative; top:10px;">
										<%= text_field_tag :add_announcement_date, params[:add_announcement_date], :size => 30 %>
									</span>
									<span style="position:relative; top:20px;">
										<%= text_area_tag :add_announcement_summary, params[:add_announcement_summary], :size => "40x9" %>
									</span>
									<span style="position:relative; top:25px; float:right; left:172px;">
										<%= submit_tag "Save" %>
									</span>
									<span style="position:relative; float:right; left:230px;">
										<%= button_to_function "Cancel", "cancelAnnAdd()" %>
									</span>
								</div>
						<% end %>
					</div>
		    </fieldset>
		</div>
	    
	  </div>
	  <script language="text/javascript" type="text/javascript">
			function clickEditAnn() {
				var j = nlr10.selected;
				document.getElementById("edit_announcement_date").value = nlr10.elements[j][0];
				document.getElementById("edit_announcement_name").value = nlr10.elements[j][1];
				document.getElementById("edit_announcement_summary").value = nlr10.elements[j][2];
				document.getElementById("edit_announcement_id").value = nlr10.elements[j][3];		
				Element.show("editAnnouncement");
			}
			function cancelAnnAdd() {
				Element.hide("addAnnouncement");
				document.getElementById("add_announcement_date").value = ""
				document.getElementById("add_announcement_name").value = ""
				document.getElementById("add_announcement_summary").value = ""
				document.getElementById("add_announcement_id").value = ""		
				
			}
			function cancelAnnEdit() {
				document.getElementById("edit_announcement_date").value = ""
				document.getElementById("edit_announcement_name").value = ""
				document.getElementById("edit_announcement_summary").value = ""
				document.getElementById("edit_announcement_id").value = ""
				Element.hide("editAnnouncement");		
			}
			function clickDeleteAnn(){
				var j = nlr10.selected;
				document.getElementById("delete_announcement_id").value = nlr10.elements[j][3];
				document.getElementById("delete_announcement_name").value = nlr10.elements[j][1];
				document.getElementById("delete_ann").submit();	
			}
			function clickAddAnn(){
				Element.show("addAnnouncement");
			}
				
		</script>
	  
	  <div class="tab-page" id="tabPage1">
	    <h2 class="tab">User Management</h2>
	    
	    <script type="text/javascript">tp1.addTabPage( document.getElementById( "tabPage1" ) );</script>
		
		Search: <select><option>All</option><option>Blocked</option><option>Last Name</option></select> <input type="button" value="Search">
		<div class="sys_groupbox1">
			<fieldset class="fieldset" style="width: 400px; height:573px;">
				<legend class="groupbox">Users</legend>
				<script language="text/javascript" type="text/javascript">
					<!--
					//  let's create our list object
					var nlr5=new mylist('nlr5','dvia5',4,100,150,70,100);
					//  set it's width and height  
					nlr5.setDims(300,100);
					//  create array for item addition - you can use the same array for the header and items
					var ae=new Array(4);
					//  fill the array with contents (now for the header)
					ae[0]='Username';
					ae[1]='Name';
					ae[2]='# of Wards';
					ae[3]='Status';
					//  update the header and redraw
					nlr5.updateHeader(ae);
					ae[0]='tagbat';
					ae[1]='Raphael Trilcoy';
					ae[2]='1';
					ae[3]='Active';
					nlr5.silentAdd(ae);					
					ae[0]='superfather';
					ae[1]='Farman Galow';
					ae[2]='2';
					ae[3]='Active';
					nlr5.silentAdd(ae);
					ae[0]='doctormom';
					ae[1]='Steth Oscope';
					ae[2]='1';
					ae[3]='Blocked';
					nlr5.silentAdd(ae);
					ae[0]='macatag';
					ae[1]='Jose Macatag';
					ae[2]='3';
					ae[3]='Blocked';
					nlr5.silentAdd(ae);					
					ae[0]='dreamerdrummer';
					ae[1]='Tommy Lee';
					ae[2]='4';
					ae[3]='Active';
					nlr5.silentAdd(ae);					
					ae[0]='superguardian';
					ae[1]='Jonathan Kent';
					ae[2]='2';
					ae[3]='Blocked';
					nlr5.silentAdd(ae);
					ae[0]='lindows';
					ae[1]='Dough Nux';
					ae[2]='2';
					ae[3]='Active';
					nlr5.silentAdd(ae);
					ae[0]='overnighter';
					ae[1]='Ace Ventura';
					ae[2]='5';
					ae[3]='Active';
					nlr5.silentAdd(ae);
					ae[0]='shreker';
					ae[1]='Fiona Giselle';
					ae[2]='1';
					ae[3]='Active';
					nlr5.silentAdd(ae);					
					ae[0]='converse';
					ae[1]='Chuck Taylor';
					ae[2]='3';
					ae[3]='Blocked';
					nlr5.silentAdd(ae);
					ae[0]='cutestmom';
					ae[1]='Missy Lohan';
					ae[2]='6';
					ae[3]='Active';
					nlr5.silentAdd(ae);
					ae[0]='bleeder';
					ae[1]='Leona Lewis';
					ae[2]='1';
					ae[3]='Active';
					nlr5.silentAdd(ae);					
					ae[0]='loveis';
					ae[1]='Sung Hsu';
					ae[2]='1';
					ae[3]='Active';
					nlr5.silentAdd(ae);					
					ae[0]='';
					ae[1]='';
					ae[2]='';
					ae[3]='';
					nlr5.silentAdd(ae);
					ae[0]='';
					ae[1]='';
					ae[2]='';
					ae[3]='';
					nlr5.silentAdd(ae);
					ae[0]='';
					ae[1]='';
					ae[2]='';
					ae[3]='';
					nlr5.silentAdd(ae);
					ae[0]='';
					ae[1]='';
					ae[2]='';
					ae[3]='';
					nlr5.silentAdd(ae);					
					ae[0]='';
					ae[1]='';
					ae[2]='';
					ae[3]='';
					nlr5.silentAdd(ae);
					ae[0]='';
					ae[1]='';
					ae[2]='';
					ae[3]='';
					nlr5.silentAdd(ae);
					ae[0]='';
					ae[1]='';
					ae[2]='';
					ae[3]='';
					nlr5.silentAdd(ae);					
					ae[0]='';
					ae[1]='';
					ae[2]='';
					ae[3]='';
					nlr5.silentAdd(ae);					
					ae[0]='';
					ae[1]='';
					ae[2]='';
					ae[3]='';
					nlr5.silentAdd(ae);
					ae[0]='';
					ae[1]='';
					ae[2]='';
					ae[3]='';
					nlr5.silentAdd(ae);
					ae[0]='';
					ae[1]='';
					ae[2]='';
					ae[3]='';
					nlr5.silentAdd(ae);
					
					nlr5.draw();
					-->  
				</script>
				<br />
				<div style="position:relative; float:right; top:-3px;">
					<input type="button" name="btn" value="Block">
					<input type="button" name="btn" value="Unblock">
				</div>
		    </fieldset>
		</div>
		<div class="sys_groupbox2">
			<fieldset class="fieldset" style="width:430px; height:573px;">
				<legend class="groupbox">Edit</legend>
					<div style="float:left; left:10px; text-align:right; width:155px;">
						<span style="position:relative; top:3px;">
							Name: <br />
						</span>
						<span style="position:relative; top:17px;">
							Address: <br />
						</span>
						<span style="position:relative; top:31px;">
							E-mail: <br />
						</span>
						<span style="position:relative; top:48px;">
							Last Date/Time Logged in: <br />
						</span>
						<span style="position:relative; top:69px;">
							Student/s being followed:
						</span>
					</div>
					<div style="position:relative; float:left; width: 80px;">
						<span style="position:relative; top:0px;">
							<input type="text" size="40" /><br />
						</span>
						<span style="position:relative; top:8px;">
							<input type="text" size="40" /><br />
						</span>
						<span style="position:relative; top:17px;">
							<input type="text" size="40" />
						</span>
						<span style="position:relative; top:28px;">
							<input type="text" size="40" />
						</span>
						<span style="position:relative; top:42px;">
							<input type="text" size="40" style="height:380px;" />
						</span>
						<span style="position:relative; float:right; top:58px; left:185px;">
							<input type="button" value="Save" />
						</span>
					</div>
		    </fieldset>		
		</div>
		
	  </div>

	  <div class="tab-page" id="tabPage2">
	    <h2 class="tab">User Query</h2>
	    
	    <script type="text/javascript">tp1.addTabPage( document.getElementById( "tabPage2" ) );</script>
	    
		From: <select><option>September 15, 2008</option></select>&nbsp;&nbsp;&nbsp;To: <select><option>September 20, 2008</option></select>
		&nbsp;&nbsp<input type="button" value="Filter" />
		<br /><br />
		
		<fieldset class="fieldset" style="width:920px; height:240px;">
			<div style="position:relative;height:200px; overflow:auto;"onclick="clickUserQuery()">
			<script language="text/javascript" type="text/javascript">
				<!--
				//  let's create our list object
				var nlr6=new mylist('nlr6','dvia6',5,210,190,300,140,60);
				//  set it's width and height  
				nlr6.setDims(300,80);
				//  create array for item addition - you can use the same array for the header and items
				var af=new Array(7);
				//  fill the array with contents (now for the header)
				af[0]='From';
				af[1]='E-mail';
				af[2]='Subject';				
				af[3]='Date/Time';
				af[4]='Resolved';

				//  update the header and redraw
				nlr6.updateHeader(af);

				<% @queries.each{ |query| %>
				<% cur_user = User.find(query.user_id) %>
						af[0]= <%= cur_user.get_full_name.to_json %>
						af[1]= <%= cur_user.email.to_json %>
						af[2]= <%= query.subject.to_json %>
						af[3]= <%= query.created_at.strftime("%m/%d/%Y %I:%M%p").to_json %>
						af[4]= <%= if query.resolved then ('Yes').to_json else ('No').to_json end %>
						af[5]= <%= query.message.to_json %>
						af[6]= <%= query.id.to_json %>
						nlr6.silentAdd(af)
					<% } %>
					<% remain = 8 - @queries.length %>
					<% if remain > 0 %>
						<% remain.times do %>
							af[0]= ''
							af[1]= ''
							af[2]= ''
							af[3]= ''
							af[4]= ''
							af[5]= ''
							af[5]= ''
							nlr6.silentAdd(af)
						<% end %>
					<% end %>			
			
				nlr6.draw();
				-->  
			</script>
			</div>
			<div style="position:absolute; top:263px; width:96%;">
				<span style="position:relative; float:right">
					<%= button_to_function 'Resolve', "resolveQuery()" %> 
					<%= button_to_function "Delete", "deleteUserQuery()" %>
					
				</span>
			</div>
		</fieldset>
		
	    
		<fieldset id= "Sender" class="fieldset" style="width: 920px; height: 80px;display:none;">
		<legend class="groupbox">Sender</legend>
		<label for="First_name">From:
      					<%= text_field_tag :message_sender, nil, :size => 45 %>
      				</label><br> <br>
		<label for="First_name">Subject:
      					<%= text_field_tag :message_subject, nil, :size => 45 %>
      				</label>
		</fieldset>
		
		<fieldset id= "MessageBox" class="fieldset" style="width: 920px; height: 208px;display:none;">
		<legend class="groupbox">Message</legend>
		<%= text_area_tag :message_area, nil, :size => "129x10" %>
		<span style="position:relative; float:right;">
		<%= button_to_function 'Reply', "openEmail()" %> 
		</span>
		</fieldset>
		<% form_tag '/admin/delete_query', :id => "delete_query" do %>
							<%= hidden_field_tag :delete_user_query_id, params[:delete_user_query_id] %>
							<%= hidden_field_tag :delete_user_query_subject, params[:delete_user_query_subject] %>
							<%= hidden_field_tag :delete_user_query_sender, params[:delete_user_query_sender] %>
		<% end %>
		<% form_tag '/admin/resolve_query', :id => "resolve_query" do %>
							<%= hidden_field_tag :resolve_user_query_id, params[:resolve_user_query_id] %>
							<%= hidden_field_tag :resolve_user_query_subject, params[:resolve_user_query_subject] %>
							<%= hidden_field_tag :resolve_user_query_sender, params[:resolve_user_query_sender] %>
		<% end %>
	  </div>
	  <script language="text/javascript" type="text/javascript">
			function clickUserQuery() {
				var i = nlr6.selected;
				document.getElementById("message_sender").value = nlr6.elements[i][0];
				document.getElementById("message_subject").value = nlr6.elements[i][2];
				document.getElementById("message_area").value = nlr6.elements[i][5];
				document.getElementById("delete_user_query_id").value = nlr6.elements[i][6];	
				document.getElementById("delete_user_query_subject").value = nlr6.elements[i][2];
				document.getElementById("delete_user_query_sender").value = nlr6.elements[i][0];
				document.getElementById("resolve_user_query_id").value = nlr6.elements[i][6];
				document.getElementById("resolve_user_query_subject").value = nlr6.elements[i][2];
				document.getElementById("resolve_user_query_sender").value = nlr6.elements[i][0];
				Element.show("Sender");
				Element.show("MessageBox");
					
			}
			function deleteUserQuery() {
				document.getElementById("delete_query").submit();
				Element.hide("Sender");
				Element.hide("MessageBox");
			}
			function openEmail() {
				var i = nlr6.selected;
				window.location = "mailto:" + nlr6.elements[i][1];
				Element.hide("Sender");
				Element.hide("MessageBox");
			}
			function resolveQuery() {
				document.getElementById("resolve_query").submit();
			}
		</script>
		<div class="tab-page" id="tabPage11">
			 <h2 class="tab">Site Settings</h2>
			<div style="position:relative; float:right; left:-9px;">
				Website Status: <select><option>Online</option><option>Offline</option></select> <input type="button" value="Change">
			</div>
		</div>
</div> <!--end of container-->

<script type="text/javascript">

setupAllTabs();


</script>

</body>
</html>

